{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | DisgrasEye</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Section hiding for navigation */
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        /* Pulse animation for alerts */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .pulse-alert {
            animation: pulse 2s infinite;
        }
        /* Camera grid styling */
        .camera-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .camera-feed {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        .camera-status {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        /* Video controls */
        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
        .video-player {
            width: 100%;
            border-radius: 12px;
            background: #000;
        }
        .video-controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .video-controls button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px;
        }
        .progress-bar {
            flex-grow: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            position: relative;
            cursor: pointer;
        }
        .progress {
            position: absolute;
            height: 100%;
            background: #38BDF8;
            border-radius: 2px;
            width: 0%;
        }
        /* Animations */
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-slow { animation: pulse-slow 2s ease-in-out infinite; }
        
        @keyframes slide-up {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-up { animation: slide-up 0.6s ease-out; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #0A192F 0%, #1E3A8A 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
    <script>
        tailwind.config = {
          theme: {
            extend: {
              colors: {
                darkblue: '#0A192F',
                sky: '#38BDF8',
                gold: '#FCD34D',
                alert: '#EF4444',
                graylight: '#CBD5E1',
                greenlight: '#22C55E',
                darkbg: '#112240',
                cardbg: '#1E293B'
              }
            }
          }
        }

        // Global variables
        let dashboardData = {};
        let charts = {};

        // Navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial data
            loadDashboardData();
            
            // Show dashboard by default
            showSection('dashboard');
            
            // Navigation click handlers
            document.querySelectorAll('nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    if (!this.hasAttribute('href') || this.getAttribute('href') === '#') {
                        e.preventDefault();
                        const target = this.getAttribute('data-section') || 'dashboard';
                        showSection(target);
                        
                        // Update active nav item
                        document.querySelectorAll('nav a').forEach(a => {
                            a.classList.remove('bg-sky', 'hover:bg-sky/80');
                            a.classList.add('hover:bg-gray-800');
                        });
                        this.classList.add('bg-sky', 'hover:bg-sky/80');
                        this.classList.remove('hover:bg-gray-800');
                    }
                });
            });

            function showSection(sectionId) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show target section
                document.getElementById(sectionId).classList.add('active');
                
                // Initialize charts if showing reports section
                if (sectionId === 'reports') {
                    setTimeout(initializeCharts, 100);
                }
            }

            function loadDashboardData() {
                // Show loading state
                document.getElementById('lastUpdate').textContent = 'Last update: Loading...';
                
                // Fetch recent detections from API
                fetch('/api/detections/')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.detections) {
                            processDashboardData(data.detections);
                            updateLastUpdateTime();
                        } else {
                            throw new Error('No detections data received');
                        }
                    })
                    .catch(error => {
                        console.error('Error loading dashboard data:', error);
                        // Use fallback data
                        useFallbackData();
                    });
            }

            function processDashboardData(detections) {
                // Calculate dynamic stats
                const today = new Date().toDateString();
                const accidentsToday = detections.filter(d => 
                    new Date(d.timestamp).toDateString() === today && d.crash_detected
                ).length;
                
                const pendingAlerts = detections.filter(d => 
                    d.crash_detected && d.status.includes('Crash Detected')
                ).length;
                
                const respondedCases = detections.filter(d => 
                    d.crash_detected
                ).length - pendingAlerts;

                const totalDetections = detections.length;
                const crashDetectionRate = totalDetections > 0 ? 
                    Math.round((detections.filter(d => d.crash_detected).length / totalDetections) * 100) : 0;

                // Update stats cards
                document.getElementById('accidentsToday').textContent = accidentsToday;
                document.getElementById('pendingAlerts').textContent = pendingAlerts;
                document.getElementById('respondedCases').textContent = respondedCases;
                document.getElementById('totalDetections').textContent = totalDetections;
                document.getElementById('crashDetectionRate').textContent = crashDetectionRate + '%';
                document.getElementById('detectionRateBar').style.width = crashDetectionRate + '%';

                // Update recent alerts table
                updateRecentAlerts(detections);

                // Update system status
                updateSystemStatus(detections);

                // Store for other functions
                dashboardData = {
                    accidentsToday,
                    pendingAlerts,
                    respondedCases,
                    totalDetections,
                    crashDetectionRate,
                    recentDetections: detections
                };
            }

            function updateRecentAlerts(detections) {
                const tbody = document.querySelector('#recentAlertsTable tbody');
                if (tbody) {
                    const recentDetections = detections.slice(0, 8); // Show last 8 detections
                    
                    if (recentDetections.length > 0) {
                        tbody.innerHTML = recentDetections.map(detection => `
                            <tr class="border-b border-gray-600 hover:bg-gray-600/30 transition-colors">
                                <td class="py-3 px-4">${new Date(detection.timestamp).toLocaleString()}</td>
                                <td class="py-3 px-4">CCTV Camera ${detection.id || 'Unknown'}</td>
                                <td class="py-3 px-4">
                                    <span class="inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${
                                        detection.crash_detected ? 'bg-alert/50 text-alert' : 'bg-greenlight/50 text-greenlight'
                                    }">
                                        ${detection.crash_detected ? 'High' : 'Low'}
                                    </span>
                                </td>
                                <td class="py-3 px-4 ${detection.crash_detected ? 'text-alert' : 'text-greenlight'} flex items-center gap-1">
                                    <i class="fas ${detection.crash_detected ? 'fa-exclamation-triangle' : 'fa-check-circle'}"></i>
                                    ${detection.status}
                                </td>
                                <td class="py-3 px-4 text-right">
                                    ${detection.confidence || 'N/A'}%
                                </td>
                            </tr>
                        `).join('');
                    } else {
                        tbody.innerHTML = `
                            <tr>
                                <td colspan="5" class="py-8 text-center text-gray-500">
                                    <i class="fas fa-info-circle text-2xl mb-2"></i><br>
                                    No recent alerts found
                                </td>
                            </tr>
                        `;
                    }
                }
            }

            function updateSystemStatus(detections) {
                const statusElement = document.getElementById('systemStatus');
                const statusIcon = document.getElementById('statusIcon');
                const statusText = document.getElementById('statusText');
                
                if (detections.length > 0) {
                    const recentDetection = detections[0];
                    const timeDiff = new Date() - new Date(recentDetection.timestamp);
                    const minutesAgo = Math.floor(timeDiff / (1000 * 60));
                    
                    if (minutesAgo < 5) {
                        // System is active and receiving data
                        statusElement.className = 'bg-greenlight/20 text-greenlight text-sm px-3 py-1 rounded-full flex items-center gap-1';
                        statusIcon.className = 'fas fa-circle animate-pulse';
                        statusText.textContent = 'System Active';
                    } else {
                        // System might be delayed
                        statusElement.className = 'bg-gold/20 text-gold text-sm px-3 py-1 rounded-full flex items-center gap-1';
                        statusIcon.className = 'fas fa-exclamation-triangle';
                        statusText.textContent = 'Delayed Data';
                    }
                } else {
                    // No data
                    statusElement.className = 'bg-alert/20 text-alert text-sm px-3 py-1 rounded-full flex items-center gap-1';
                    statusIcon.className = 'fas fa-exclamation-circle';
                    statusText.textContent = 'No Data';
                }
            }

            function updateLastUpdateTime() {
                const now = new Date();
                document.getElementById('lastUpdate').textContent = 
                    `Last update: ${now.toLocaleTimeString()}`;
            }

            function useFallbackData() {
                // Fallback data if API fails
                const fallbackDetections = [
                    {
                        id: 1,
                        timestamp: new Date().toISOString(),
                        crash_detected: true,
                        confidence: 92,
                        status: 'Crash Detected',
                        crash_reason: 'Vehicle collision at intersection'
                    },
                    {
                        id: 2,
                        timestamp: new Date(Date.now() - 3600000).toISOString(),
                        crash_detected: false,
                        confidence: 85,
                        status: 'No Crash'
                    },
                    {
                        id: 3,
                        timestamp: new Date(Date.now() - 7200000).toISOString(),
                        crash_detected: true,
                        confidence: 88,
                        status: 'Crash Detected',
                        crash_reason: 'Multiple vehicle accident'
                    },
                    {
                        id: 4,
                        timestamp: new Date(Date.now() - 10800000).toISOString(),
                        crash_detected: false,
                        confidence: 91,
                        status: 'No Crash'
                    }
                ];
                
                processDashboardData(fallbackDetections);
                updateLastUpdateTime();
            }

            // Initialize charts for reports section
            function initializeCharts() {
                // Destroy existing charts
                Object.values(charts).forEach(chart => {
                    if (chart) chart.destroy();
                });
                
                // Monthly Crash Trends Chart
                const monthlyCtx = document.getElementById('monthlyCrashChart');
                if (monthlyCtx) {
                    charts.monthlyCrashChart = new Chart(monthlyCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                            datasets: [{
                                label: 'Crashes Detected',
                                data: [12, 19, 15, 25, 22, 30, 28, 26, 24, 20, 18, 22],
                                borderColor: '#38BDF8',
                                backgroundColor: 'rgba(56, 189, 248, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: { color: '#CBD5E1' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: { color: 'rgba(203, 213, 225, 0.1)' },
                                    ticks: { color: '#CBD5E1' }
                                },
                                x: {
                                    grid: { color: 'rgba(203, 213, 225, 0.1)' },
                                    ticks: { color: '#CBD5E1' }
                                }
                            }
                        }
                    });
                }

                // Crash Type Distribution Chart
                const crashTypeCtx = document.getElementById('crashTypeChart');
                if (crashTypeCtx) {
                    charts.crashTypeChart = new Chart(crashTypeCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Rear-end', 'Side-impact', 'Head-on', 'Rollover', 'Other'],
                            datasets: [{
                                data: [45, 25, 15, 10, 5],
                                backgroundColor: [
                                    '#EF4444',
                                    '#F59E0B',
                                    '#10B981',
                                    '#3B82F6',
                                    '#8B5CF6'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { color: '#CBD5E1' }
                                }
                            }
                        }
                    });
                }

                // Response Time Analysis Chart
                const responseTimeCtx = document.getElementById('responseTimeChart');
                if (responseTimeCtx) {
                    charts.responseTimeChart = new Chart(responseTimeCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                            datasets: [{
                                label: 'Avg Response Time (min)',
                                data: [2.3, 1.8, 2.5, 1.9, 2.1, 2.8, 2.4],
                                backgroundColor: '#10B981'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: { color: '#CBD5E1' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: { color: 'rgba(203, 213, 225, 0.1)' },
                                    ticks: { color: '#CBD5E1' }
                                },
                                x: {
                                    grid: { color: 'rgba(203, 213, 225, 0.1)' },
                                    ticks: { color: '#CBD5E1' }
                                }
                            }
                        }
                    });
                }

                // Camera Performance Chart
                const cameraPerformanceCtx = document.getElementById('cameraPerformanceChart');
                if (cameraPerformanceCtx) {
                    charts.cameraPerformanceChart = new Chart(cameraPerformanceCtx, {
                        type: 'radar',
                        data: {
                            labels: ['Detection Rate', 'Uptime', 'Image Quality', 'Network Stability', 'Alert Accuracy'],
                            datasets: [{
                                label: 'Camera Performance',
                                data: [85, 92, 78, 88, 82],
                                backgroundColor: 'rgba(56, 189, 248, 0.2)',
                                borderColor: '#38BDF8',
                                pointBackgroundColor: '#38BDF8'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    angleLines: { color: 'rgba(203, 213, 225, 0.1)' },
                                    grid: { color: 'rgba(203, 213, 225, 0.1)' },
                                    pointLabels: { color: '#CBD5E1' },
                                    ticks: { 
                                        color: '#CBD5E1',
                                        backdropColor: 'transparent'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    labels: { color: '#CBD5E1' }
                                }
                            }
                        }
                    });
                }
            }

            // Auto-refresh dashboard data every 30 seconds
            setInterval(loadDashboardData, 30000);
        });

        // Make functions globally available
        window.loadDashboardData = loadDashboardData;
    </script>
</head>
<body class="bg-darkblue text-graylight font-sans">

<!-- Header -->
<header class="flex justify-between items-center p-4 bg-[#091527] border-b border-sky/30">
    <h1 class="text-xl font-bold text-sky flex items-center gap-2">
        <i class="fas fa-exclamation-triangle text-alert"></i> DisgrasEye Dashboard
    </h1>
    <div class="flex items-center gap-4">
        <span class="text-sm text-gray-400" id="lastUpdate">Last update: Loading...</span>
        <form action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="bg-alert hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </form>
    </div>
</header>

<div class="flex flex-col lg:flex-row min-h-screen">

    <!-- Sidebar -->
    <aside class="w-full lg:w-64 bg-[#0F172A] p-4 lg:min-h-screen">
        <nav class="flex flex-row lg:flex-col gap-2 lg:gap-4 overflow-x-auto lg:overflow-x-visible">
            <a href="#" data-section="dashboard" class="flex items-center px-4 py-2 bg-sky rounded-lg hover:bg-sky/80 transition">
                <i class="fas fa-home mr-3"></i><span class="hidden sm:inline">Dashboard</span>
            </a>
            <a href="#" data-section="cctvMonitoring" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded-lg transition">
                <i class="fas fa-video mr-3"></i><span class="hidden sm:inline">CCTV Monitoring</span>
            </a>
            <a href="{% url 'demo' %}" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded-lg transition">
                <i class="fas fa-satellite-dish mr-3"></i><span class="hidden sm:inline">Live Detection</span>
            </a>
            <a href="#" data-section="reports" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded-lg transition">
                <i class="fas fa-chart-bar mr-3"></i><span class="hidden sm:inline">Reports</span>
            </a>
            <a href="#" data-section="settings" class="flex items-center px-4 py-2 hover:bg-gray-800 rounded-lg transition">
                <i class="fas fa-cog mr-3"></i><span class="hidden sm:inline">Settings</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6 lg:p-8 bg-[#112240]">
        
        <!-- Dashboard Section -->
        <div id="dashboard" class="section active">
            <!-- Hero Welcome -->
            <div class="gradient-bg rounded-2xl p-8 mb-8 text-center relative overflow-hidden">
                <div class="absolute inset-0 opacity-10">
                    <div class="absolute w-64 h-64 bg-sky rounded-full -top-16 -left-16 pulse-slow"></div>
                    <div class="absolute w-64 h-64 bg-alert rounded-full -bottom-16 -right-16 pulse-slow" style="animation-delay: 1s;"></div>
                </div>
                <div class="relative z-10 slide-up">
                    <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">DisgrasEye Dashboard</h1>
                    <p class="text-xl text-graylight mb-6">AI-Powered Real-Time Vehicle Crash Detection System</p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a href="#" data-section="cctvMonitoring" class="bg-sky hover:bg-sky/80 text-white px-6 py-3 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg flex items-center gap-2">
                            <i class="fas fa-video"></i> Monitor CCTV Feeds
                        </a>
                        <a href="{% url 'demo' %}" class="bg-alert hover:bg-alert/80 text-white px-6 py-3 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg flex items-center gap-2">
                            <i class="fas fa-satellite-dish"></i> Live Detection
                        </a>
                        <a href="#" data-section="reports" class="bg-greenlight hover:bg-greenlight/80 text-white px-6 py-3 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg flex items-center gap-2">
                            <i class="fas fa-chart-bar"></i> View Reports
                        </a>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-[#1E293B] p-6 rounded-xl shadow hover:shadow-lg transition transform hover:-translate-y-1 border border-sky/20">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-gray-400">Accidents Today</p>
                            <h2 class="text-3xl font-bold text-sky mt-2" id="accidentsToday">0</h2>
                        </div>
                        <div class="bg-sky/20 p-3 rounded-lg">
                            <i class="fas fa-car-crash text-sky text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-[#1E293B] p-6 rounded-xl shadow hover:shadow-lg transition transform hover:-translate-y-1 border border-alert/20">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-gray-400">Pending Alerts</p>
                            <h2 class="text-3xl font-bold text-alert mt-2 pulse-alert" id="pendingAlerts">0</h2>
                        </div>
                        <div class="bg-alert/20 p-3 rounded-lg">
                            <i class="fas fa-exclamation-circle text-alert text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-[#1E293B] p-6 rounded-xl shadow hover:shadow-lg transition transform hover:-translate-y-1 border border-greenlight/20">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-gray-400">Responded Cases</p>
                            <h2 class="text-3xl font-bold text-greenlight mt-2" id="respondedCases">0</h2>
                        </div>
                        <div class="bg-greenlight/20 p-3 rounded-lg">
                            <i class="fas fa-check-circle text-greenlight text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="bg-[#1E293B] p-6 rounded-xl shadow hover:shadow-lg transition transform hover:-translate-y-1 border border-gold/20">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-gray-400">Detection Accuracy</p>
                            <h2 class="text-3xl font-bold text-gold mt-2" id="crashDetectionRate">0%</h2>
                        </div>
                        <div class="bg-gold/20 p-3 rounded-lg">
                            <i class="fas fa-bullseye text-gold text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Status and Performance Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- System Status Card -->
                <div class="bg-[#1E293B] rounded-xl shadow overflow-hidden border border-gray-600">
                    <div class="p-6 border-b border-gray-600">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-heartbeat text-sky"></i>
                                <h3 class="text-xl font-bold">System Status</h3>
                            </div>
                            <span id="systemStatus" class="bg-greenlight/20 text-greenlight text-sm px-3 py-1 rounded-full flex items-center gap-1">
                                <i id="statusIcon" class="fas fa-circle animate-pulse"></i>
                                <span id="statusText">System Active</span>
                            </span>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Crash Detection Rate</span>
                                <span class="text-2xl font-bold text-sky" id="crashDetectionRate">0%</span>
                            </div>
                            <div class="w-full bg-gray-600 rounded-full h-2">
                                <div id="detectionRateBar" class="bg-sky h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div class="text-center p-3 bg-sky/10 rounded-lg">
                                    <div class="text-sky font-bold text-lg" id="respondedCases">0</div>
                                    <div class="text-gray-400">Responded</div>
                                </div>
                                <div class="text-center p-3 bg-alert/10 rounded-lg">
                                    <div class="text-alert font-bold text-lg" id="pendingAlerts">0</div>
                                    <div class="text-gray-400">Pending</div>
                                </div>
                                <div class="text-center p-3 bg-gold/10 rounded-lg">
                                    <div class="text-gold font-bold text-lg" id="totalDetections">0</div>
                                    <div class="text-gray-400">Total</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions Card -->
                <div class="bg-[#1E293B] rounded-xl shadow overflow-hidden border border-gray-600">
                    <div class="p-6 border-b border-gray-600">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-bolt text-gold"></i>
                            <h3 class="text-xl font-bold">Quick Actions</h3>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-2 gap-4">
                            <a href="#" data-section="cctvMonitoring" class="bg-sky hover:bg-sky/80 text-white p-4 rounded-lg text-center transition transform hover:scale-105">
                                <i class="fas fa-video text-2xl mb-2"></i>
                                <div class="font-semibold">Live CCTV</div>
                                <div class="text-sm opacity-80">Monitor Feeds</div>
                            </a>
                            <a href="{% url 'demo' %}" class="bg-alert hover:bg-alert/80 text-white p-4 rounded-lg text-center transition transform hover:scale-105">
                                <i class="fas fa-satellite-dish text-2xl mb-2"></i>
                                <div class="font-semibold">Sample Detection</div>
                                <div class="text-sm opacity-80">Test System</div>
                            </a>
                            <a href="#" data-section="reports" class="bg-greenlight hover:bg-greenlight/80 text-white p-4 rounded-lg text-center transition transform hover:scale-105">
                                <i class="fas fa-chart-bar text-2xl mb-2"></i>
                                <div class="font-semibold">Reports</div>
                                <div class="text-sm opacity-80">View Analytics</div>
                            </a>
                            <button onclick="loadDashboardData()" class="bg-gold hover:bg-gold/80 text-gray-900 p-4 rounded-lg text-center transition transform hover:scale-105">
                                <i class="fas fa-sync-alt text-2xl mb-2"></i>
                                <div class="font-semibold">Refresh</div>
                                <div class="text-sm opacity-80">Update Data</div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Alerts Table -->
            <div class="bg-[#1E293B] rounded-xl shadow overflow-hidden border border-gray-600">
                <div class="p-6 border-b border-gray-600 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-history text-sky"></i>
                        <h3 class="text-xl font-bold">Recent Detection History</h3>
                    </div>
                    <button onclick="loadDashboardData()" class="text-sm bg-sky hover:bg-sky/80 text-white px-3 py-1 rounded transition flex items-center gap-1">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left" id="recentAlertsTable">
                        <thead class="bg-[#112240]">
                            <tr>
                                <th class="py-3 px-4">Date & Time</th>
                                <th class="py-3 px-4">Camera ID</th>
                                <th class="py-3 px-4">Severity</th>
                                <th class="py-3 px-4">Status</th>
                                <th class="py-3 px-4 text-right">Confidence</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" class="py-8 text-center text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-2xl mb-2"></i><br>
                                    Loading detection data...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- CCTV Monitoring Section -->
        <div id="cctvMonitoring" class="section">
            <div class="mb-6">
                <h2 class="text-2xl font-bold flex items-center gap-2">
                    <i class="fas fa-video text-sky"></i> Live CCTV Monitoring
                </h2>
                <p class="text-gray-400 mt-2">Real-time surveillance feeds from all connected cameras</p>
            </div>

            <!-- Camera Grid -->
            <div class="camera-grid mb-8">
                <!-- Camera 1 -->
                <div class="camera-feed">
                    <div class="camera-status bg-greenlight/80">LIVE</div>
                    <div class="aspect-video bg-gradient-to-br from-sky/20 to-alert/20 flex items-center justify-center">
                        <div class="text-center text-white">
                            <i class="fas fa-video text-4xl mb-2 opacity-50"></i>
                            <p class="font-semibold">Payung 1-3</p>
                            <p class="text-sm opacity-70">Status: Active â€¢ 1080p</p>
                        </div>
                    </div>
                    <div class="p-4 bg-cardbg">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Live Feed</span>
                            <button class="bg-sky hover:bg-sky/80 text-white px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-expand mr-1"></i> Fullscreen
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Camera 2 -->
                <div class="camera-feed">
                    <div class="camera-status bg-greenlight/80">LIVE</div>
                    <div class="aspect-video bg-gradient-to-br from-gold/20 to-greenlight/20 flex items-center justify-center">
                        <div class="text-center text-white">
                            <i class="fas fa-video text-4xl mb-2 opacity-50"></i>
                            <p class="font-semibold">DPWH 1-2</p>
                            <p class="text-sm opacity-70">Status: Active â€¢ 1080p</p>
                        </div>
                    </div>
                    <div class="p-4 bg-cardbg">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Live Feed</span>
                            <button class="bg-sky hover:bg-sky/80 text-white px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-expand mr-1"></i> Fullscreen
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Camera 3 -->
                <div class="camera-feed">
                    <div class="camera-status bg-alert/80">ALERT</div>
                    <div class="aspect-video bg-gradient-to-br from-alert/20 to-red-500/20 flex items-center justify-center relative">
                        <div class="absolute inset-0 bg-alert/20 animate-pulse"></div>
                        <div class="text-center text-white relative z-10">
                            <i class="fas fa-exclamation-triangle text-4xl mb-2"></i>
                            <p class="font-semibold">CAM-003 - Market Road</p>
                            <p class="text-sm">ðŸš¨ Crash Detected - Monitoring</p>
                        </div>
                    </div>
                    <div class="p-4 bg-cardbg">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-alert">Alert Active</span>
                            <button class="bg-alert hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-play mr-1"></i> Review
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Camera 4 -->
                <div class="camera-feed">
                    <div class="camera-status bg-greenlight/80">LIVE</div>
                    <div class="aspect-video bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center">
                        <div class="text-center text-white">
                            <i class="fas fa-video text-4xl mb-2 opacity-50"></i>
                            <p class="font-semibold">Galvez 1-2</p>
                            <p class="text-sm opacity-70">Status: Active â€¢ 720p</p>
                        </div>
                    </div>
                    <div class="p-4 bg-cardbg">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Live Feed</span>
                            <button class="bg-sky hover:bg-sky/80 text-white px-3 py-1 rounded text-sm transition">
                                <i class="fas fa-expand mr-1"></i> Fullscreen
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Camera Statistics -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-cardbg p-6 rounded-xl border border-gray-600">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-network-wired text-sky"></i> Camera Status
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Online Cameras</span>
                            <span class="text-greenlight font-semibold">8/8</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Recording</span>
                            <span class="text-sky font-semibold">24/7</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Storage</span>
                            <span class="text-gold font-semibold">78%</span>
                        </div>
                    </div>
                </div>

                <div class="bg-cardbg p-6 rounded-xl border border-gray-600">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-shield-alt text-greenlight"></i> Security Status
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">AI Monitoring</span>
                            <span class="text-greenlight font-semibold">Active</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Alerts Today</span>
                            <span class="text-alert font-semibold">3</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Response Time</span>
                            <span class="text-sky font-semibold">2.3min</span>
                        </div>
                    </div>
                </div>

                <div class="bg-cardbg p-6 rounded-xl border border-gray-600">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-chart-line text-gold"></i> System Health
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Uptime</span>
                            <span class="text-greenlight font-semibold">99.8%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">CPU Load</span>
                            <span class="text-gold font-semibold">42%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Network</span>
                            <span class="text-sky font-semibold">Stable</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports" class="section">
            <div class="mb-6">
                <h2 class="text-2xl font-bold flex items-center gap-2">
                    <i class="fas fa-chart-bar text-sky"></i> Analytics & Reports
                </h2>
                <p class="text-gray-400 mt-2">Comprehensive crash detection statistics and performance metrics</p>
            </div>

            <!-- Crash Statistics Overview -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Monthly Crash Trends -->
                <div class="bg-cardbg rounded-xl p-6 border border-gray-600">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-chart-line text-sky"></i> Monthly Crash Trends
                    </h3>
                    <div class="h-64">
                        <canvas id="monthlyCrashChart"></canvas>
                    </div>
                </div>

                <!-- Crash Type Distribution -->
                <div class="bg-cardbg rounded-xl p-6 border border-gray-600">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-chart-pie text-alert"></i> Crash Type Distribution
                    </h3>
                    <div class="h-64">
                        <canvas id="crashTypeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Statistics -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 mb-8">
                <!-- Response Time Analysis -->
                <div class="bg-cardbg rounded-xl p-6 border border-gray-600">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-clock text-greenlight"></i> Response Time Analysis
                    </h3>
                    <div class="h-64">
                        <canvas id="responseTimeChart"></canvas>
                    </div>
                </div>

                <!-- Camera Performance -->
                <div class="bg-cardbg rounded-xl p-6 border border-gray-600">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-video text-gold"></i> Camera Performance
                    </h3>
                    <div class="h-64">
                        <canvas id="cameraPerformanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Report Generation -->
            <div class="bg-cardbg rounded-xl p-6 border border-gray-600">
                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-file-export text-sky"></i> Generate Reports
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-darkbg p-4 rounded-lg border border-gray-600">
                        <h4 class="font-semibold mb-2 text-sky">Daily Report</h4>
                        <p class="text-sm text-gray-400 mb-3">Generate today's crash detection summary</p>
                        <button class="w-full bg-sky hover:bg-sky/80 text-white py-2 rounded transition flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                    </div>
                    <div class="bg-darkbg p-4 rounded-lg border border-gray-600">
                        <h4 class="font-semibold mb-2 text-alert">Weekly Report</h4>
                        <p class="text-sm text-gray-400 mb-3">Weekly performance and incident analysis</p>
                        <button class="w-full bg-alert hover:bg-alert/80 text-white py-2 rounded transition flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                    </div>
                    <div class="bg-darkbg p-4 rounded-lg border border-gray-600">
                        <h4 class="font-semibold mb-2 text-greenlight">Custom Report</h4>
                        <p class="text-sm text-gray-400 mb-3">Custom date range and metrics</p>
                        <button class="w-full bg-greenlight hover:bg-greenlight/80 text-white py-2 rounded transition flex items-center justify-center gap-2">
                            <i class="fas fa-cog"></i> Configure
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="section">
            <div class="mb-6">
                <h2 class="text-2xl font-bold flex items-center gap-2">
                    <i class="fas fa-cog text-sky"></i> System Settings
                </h2>
                <p class="text-gray-400 mt-2">Configure system preferences and user management</p>
            </div>
            <div class="bg-[#1E293B] rounded-xl p-6 text-center">
                <i class="fas fa-cogs text-4xl text-gray-500 mb-4"></i>
                <h3 class="text-xl font-bold text-gray-400">System Settings</h3>
                <p class="text-gray-500 mt-2">System configuration features coming soon...</p>
            </div>
        </div>

    </main>
</div>
</body>
</html>